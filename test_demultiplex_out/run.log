
Running minimap2...
[M::mm_idx_gen::0.000*4.31] collected minimizers
[M::mm_idx_gen::0.000*3.72] sorted minimizers
[M::main::0.000*3.71] loaded/built the index for 8 target sequence(s)
[M::mm_mapopt_update::0.000*3.63] mid_occ = 11
[M::mm_idx_stat] kmer size: 5; skip: 1; is_hpc: 0; #seq: 8
[M::mm_idx_stat::0.000*3.60] distinct minimizers: 196 (68.88% are singletons); average occurrences: 2.291; average spacing: 1.071; total length: 481
[M::worker_pipeline::18.098*2.89] mapped 31594 sequences
[M::main] Version: 2.28-r1209
[M::main] CMD: minimap2 -k5 -A1 -m32 -w1 ../../sylvie_workspace/demo_files/reference_files/dual_barcodes_with_primers.fa ../../sylvie_workspace/demo_files/pangkep_raw_reads/barcode01_raw_reads.fastq.gz
[M::main] Real time: 18.099 sec; CPU: 52.290 sec; Peak RSS: 0.136 GB
minimap2 finished

removing hits from minimap2 output that are from reads that are not between 3 and 9 kb, and removing hits that have barcodes in the middle
Filtered and sorted test_demultiplex_out/intermediate_files/barcode-read_alignment.paf -> barcode_assignments.paf
Removed 3314 rows
Remaining 21900 rows are written to barcode_assignments.paf

Created empty fastq files for each barcode

Sorting reads from ../../sylvie_workspace/demo_files/pangkep_raw_reads/barcode01_raw_reads.fastq.gz based on minimap2 output...
All reads have been sorted into barcode-specific fastq files.

Trimming off barcodes and adapters with porechop...
IMPORTANT: for this step to work, the custom inner barcodes and primers must be added as adapters in porechop's adapters.py file
Chopping CtHD.fastq
Traceback (most recent call last):
  File "/usr/local/bin/porechop", line 33, in <module>
    sys.exit(load_entry_point('porechop==0.2.4', 'console_scripts', 'porechop')())
  File "/usr/local/lib/python3.10/dist-packages/porechop/porechop.py", line 35, in main
    reads, check_reads, read_type = load_reads(args.input, args.verbosity, args.print_dest,
  File "/usr/local/lib/python3.10/dist-packages/porechop/porechop.py", line 232, in load_reads
    reads, read_type = load_fasta_or_fastq(input_file_or_directory)
  File "/usr/local/lib/python3.10/dist-packages/porechop/misc.py", line 114, in load_fasta_or_fastq
    file_type = get_sequence_file_type(filename)
  File "/usr/local/lib/python3.10/dist-packages/porechop/misc.py", line 106, in get_sequence_file_type
    raise ValueError('File is neither FASTA or FASTQ')
ValueError: File is neither FASTA or FASTQ
Chopping Tc1316.fastq
Traceback (most recent call last):
  File "/usr/local/bin/porechop", line 33, in <module>
    sys.exit(load_entry_point('porechop==0.2.4', 'console_scripts', 'porechop')())
  File "/usr/local/lib/python3.10/dist-packages/porechop/porechop.py", line 35, in main
    reads, check_reads, read_type = load_reads(args.input, args.verbosity, args.print_dest,
  File "/usr/local/lib/python3.10/dist-packages/porechop/porechop.py", line 232, in load_reads
    reads, read_type = load_fasta_or_fastq(input_file_or_directory)
  File "/usr/local/lib/python3.10/dist-packages/porechop/misc.py", line 114, in load_fasta_or_fastq
    file_type = get_sequence_file_type(filename)
  File "/usr/local/lib/python3.10/dist-packages/porechop/misc.py", line 106, in get_sequence_file_type
    raise ValueError('File is neither FASTA or FASTQ')
ValueError: File is neither FASTA or FASTQ
Chopping Tc1318.fastq
Chopping Tc1320.fastq
Chopping Tc2391.fastq
Chopping Tc3078.fastq
Chopping Tc3425.fastq
Chopping Tc3618.fastq
Chopping unclassified.fastq

 porechop finished (find detailed info in test_demultiplex_out/intermediate_files/porechop.log

Final Barcode distribution:
trimmed_Tc1318.fastq  2486 ########################
trimmed_Tc1320.fastq  1206 ############
trimmed_Tc2391.fastq  2612 ##########################
trimmed_Tc3078.fastq  7320 #########################################################################
trimmed_Tc3425.fastq  1595 ###############
trimmed_Tc3618.fastq     2 
trimmed_unclassified.fastq  8106 #################################################################################

All the above output can also be found in test_demultiplex_out/run.log
